\documentclass{article}

\usepackage{../../header-colourful}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Preamble

\title{Elliptic functions, integrals, and curves}
\author{Linden Disney-Hogg}
\date{June 2020}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}

\maketitle
\tableofcontents

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction}
Elliptic integrals are hard to solve and make little sense. Fortunately, algebraic geometry can help us. These will be my personal notes which will accumulate many resources, which I will try to reference, though I doubt I will give when each one was used. The current list is 
\begin{itemize}
	\item \textit{Elliptic Funcations and Applications} (Lawden)
	\item \textit{Elliptic Curves} (McKean, Moll) 
	\item often wikipedia
	\item nlab
	\item \textit{Algebraic Curves and Riemann Surfaces} (Miranda)
\end{itemize}
These books may use different conventions, but I will keep mine uniform (\hl{unless I make an error, in which case please do let me know}). 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Preliminaries}
We should hopefully not need too many preliminaries in these notes, but those that we do will form two main categories: algebraic geometry and Riemann surfaces. I desire to eventually make notes about these subjects, but in the interim this will suffice. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Algebraic Geometry}

Recall that for any distinct $z_1, z_2, z_3 \in \mbb{C}$ we have a Mobius transform that sends them to $0,1,\infty$ given by 
\eq{
f(z) = \frac{z-z_1}{z-z_3}\frac{z_2 - z_3}{z_2 - z_1}
}
\begin{definition}
Given distinct $z_0, z_1, z_2, z_3 \in \mbb{C}$ the \bam{cross ratio} is 
\eq{
\frac{z_0-z_1}{z_0-z_3}\frac{z_2 - z_3}{z_2 - z_1}
}
\end{definition}

\begin{prop}
Distinct $z_0, z_1, z_2, z_3 \in \mbb{C}$ lie on a circline iff their cross-ratio is real. 
\end{prop}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Riemann Surfaces}

\begin{definition}
	Fix $\omega_1, \omega_2 \in \mbb{C}$ linearly independent over $\mbb{R}$ and let 
	\eq{
L = L(\omega_1, \omega_2) = \mbb{Z}\omega_1 + \mbb{Z}\omega_2 \subset \mbb{C}
}
The \bam{complex tori with lattice $\bm{L}$} is $X = \faktor{\mbb{C}}{L}$. 
\end{definition}

\begin{prop}
	Complex tori are Riemann surfaces. 
\end{prop}

\begin{prop}
	Every complex tori can be written with a lattice the form $L(1,\tau)$ where $\Im\tau > 0$
\end{prop}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\part{Functions}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Theta Functions}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Definitions}
We start this section with a warning. There are \emph{many} different ways of writing theta functions, and so you will need to be on your toes to connect those in these notes with those in other documents. These will start with the definition in 

\begin{definition}
	For $\tau \in \mbb{C}, \, \image(\tau)>0$, define the \bam{Riemann theta function} 
	\eq{
\theta(z) = \theta(z|\tau) = \sum_{n \in \mbb{Z}} e^{\pi i\psquare{n^2 \tau + 2nz}}	
}
\end{definition}

\begin{remark}
	This is the definition given in Miranda and on Wikipedia (as of June 2020). 
\end{remark}

\begin{prop}
	The series converges absolutely and uniformly on compact subset of $\mbb{C}$. Hence $\theta$ is an analytic function on $\mbb{C}$. 
\end{prop}

\begin{prop}
	We have 
	\eq{
\theta(z+1) &= \theta(z) \\
\theta(z+\tau) &= e^{-\pi i\psquare{\tau +2z}}\theta(z)
}
\end{prop}

\begin{corollary}
	$\theta(z_0) \Leftrightarrow \forall m,n \in \mbb{Z}, \, \theta(z_0 + m + n\tau)=0$ and the order of the zero is the same
\end{corollary}

\begin{prop}
	The only zeros of $\theta$ are 
	\eq{
\frac{1+\tau}{2} + L(1,\tau)	
}
and all these zeros are simple. 
\end{prop}

\begin{definition}
	The \bam{translated theta function} is 
	\eq{
\theta^{(x)}(z) = \theta\pround{z - (\sfrac{1}{2}) - (\sfrac{\tau}{2}) - x}	
}
\end{definition}

\begin{definition}
	The \bam{Jacobi theta functions} are 
	\eq{
\theta_1(z | \tau) = 	
}
\end{definition}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Jacobi Elliptic Functions}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\part{Integrals}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Elliptic integrals}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Elliptic Integral of the First Kind}
Let us start by stating our assumptions of this section, namely:
\begin{itemize}
	\item $u \in \mbb{R}$
	\item $k \in (0,1)$.
\end{itemize}

We make the following definition:

\begin{definition}
	\bam{Jacobi's incomplete elliptic integral of the first kind} is the map $\mbb{H}\to \mbb{C}$
	\eq{
x \mapsto \int_0^x \frac{1}{\sqrt{(1-t^2)(1-k^2t^2)}} dt	
}
where the integrand is taken to be real and positive for $t \in (-1,1)$, and at the branch points $\pm 1, \pm \frac{1}{k}$ the contour should take an infinitesimal circle above the point (i.e remaining in the UHP). 
\end{definition}



\begin{definition}
	The \bam{complete elliptic integral of the first kind } is 
\eq{
	K = K(k) = \int_0^1 \frac{1}{\sqrt{(1-t^2)(1-k^2t^2)}} \in \mbb{R}
}
and the \bam{complementary integral of the first kind } is 
\eq{
K^\prime = K^\prime(k) = \int_1^\frac{1}{k} \frac{1}{\sqrt{(t^2-1)(1-k^2t^2)}} \in \mbb{R}
}
\end{definition}

\begin{prop}
	$K(-k) = K(k)$ and $K(ik) = \frac{1}{\sqrt{1+k^2}}K\pround{\frac{k}{\sqrt{1+k^2}}}$
\end{prop}

These definitions make sense for the following result:

\begin{prop}
	The incomplete elliptic integral of the first kind has the following straight line segements for ranges:
	\eq{
\psquare{0,1} &\mapsto [0,K]  & [-1,0] &\mapsto [-K,0] \\
\psquare{1,\sfrac{1}{k}} &\mapsto [K,K+iK^\prime] & \psquare{-\sfrac{1}{k},1} &\mapsto \psquare{-K+iK^\prime,-K}\\
\left[\sfrac{1}{k},\infty\right) &\mapsto [K+iK^\prime,iK^\prime)	& \left( -\infty, -\sfrac{1}{k}\right] &\mapsto (iK^\prime,-K+iK^\prime]
}
\end{prop}

\begin{corollary}
	The image of the UHP under the elliptic integral of the first kind is the interior of the rectangle with corners $\pbrace{K,-K,K+iK^\prime, -K+iK^\prime}$, with the boundary of the rectangle being the image of the boundary of the UHP.
\end{corollary}

\begin{prop}
	$K^\prime(k) = K(k^\prime)$ where $k^\prime = \sqrt{1-k^2}$
\end{prop}



\begin{definition}
	The \bam{incomplete elliptic integral of the second kind} is \eq{
x \mapsto \int^x \sqrt{\frac{1-k^2 t^2}{1-t^2}} dt 	
}
\end{definition}

\begin{definition}
	The \bam{incomplete elliptic integral of the second kind} is
	\eq{
x \mapsto \int^x \frac{1}{(t^2-c^2)\sqrt{(1-t^2)(1-k^2t^2)}}	dt
}
\end{definition}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Reduction of Elliptic Integrals}

\begin{definition}
	If $R=R(x,y)$ is a rational function in $x,y$ and $y^2=Q(x)$ is a polynomial of degree $d=3,4$ with distinct roots then the integral
	\eq{
\int R(x,y) \, dx	
}
is called a \bam{general elliptic integral}. 
\end{definition}

\begin{remark}
	Dealing with integrals such as the above when $d=1,2$ or there are repeated roots are treated in your earlier calculus classes, for example:
	\begin{itemize}
		\item $d=1$: write $y^2 = ax+b$ and make the substitution 
		\eq{
	x \mapsto \frac{1}{a}(x^2-b)	
	}
		\item $d=2$: write $y^2 = c(x-a)(x-b)$ and make the substitution 
		\eq{
	x \mapsto a = \frac{1}{4}(b-a) \pround{x - \frac{1}{x}}^2	
	}
	\end{itemize}
\end{remark}

\begin{remark}
	Depending on how the layout of this document ends up being, I may have a the section on Jacobi elliptic functions first. In this case, one would see that the incomplete integral of the first kind corresponds to the inverse of the function $\sn$. We could also generate integrals from the inverses of $\cn, \dn$. However from theory of elliptic functions, we know we can write the inverses of these in terms of $\sn^{-1}$, so transforms must exists for their corresponding integrals to reduce them to "known" forms. The same idea applies to the reduction of general elliptic integrals and we will see that now. 
\end{remark}

\begin{prop}
A general elliptic integral can be written as 
\eq{
\int \psquare{y^{-1}R_1(x) + R_2(x)}\, dx 
}	
\end{prop}
As a results of this, because any rational integral can be solved through partial fractions, in order to study general elliptic integrals we need know only how to deal with integrals of the form 
\eq{
\int \frac{R(x)}{y} dx
}
Let us start to deal with these:
\subsubsection{\secmath{d=3}}
Write 
\eq{
Q(x) = (x-e_0)(x-e_1)(x-e_2)
}
with $e_0,e_1,e_2$ distinct. Make the substitution 
\eq{
x \mapsto x^2 + e_0
}
sending 
\eq{
\frac{dx}{y} \mapsto \frac{2dx}{\sqrt{(x^2 + e_0 - e_1)(x^2 + e_0 - e_2)}}
}
The new $Q$ has roots $\pm \sqrt{e_1 - e_0}, \, \pm\sqrt{e_2 - e_0}$, so wlog we may take $d=4$.
\subsubsection{\secmath{d=4}}
We make now start procedurally:
\begin{enumerate}
	\item Write $Q(x) = (x-e_0)(x-e_1)(x-e_2)(x-e_3)$
	\item Send $e_0, \dots, e_3$ to $\pm1, \pm \frac{1}{k}$ using a fractional linear transform. This sends $Q(x) \mapsto (1-x^2)(1-k^2 x^2)$. This is possible if the cross ratio is 
	\eq{
	\frac{e_0 - e_1}{e_0 - e_3}\frac{e_2 - e_3}{e_2 - e_1} = \frac{4k}{(1+k)^2}
}
The distinctness of the $e$ means that the cross ratio is not $0,1,\infty$ and so $k \neq 0, \pm 1$.
\item Write $R(x) = R_1(x^2) + xR_2(x^2)$ and note 
\eq{
\int \frac{xR_2(x^2)}{\sqrt{(1-x^2)(1-k^2x^2)}} dx  = \frac{1}{2} \int \frac{R_2(x^2)}{\sqrt{(1-x^2)(1-k^2x^2)}} d(x^2)
}
Hence this term reduces to previously solved cases ($d=2$). As such we are reduced to the case of
\eq{
\int \frac{R(x^2)}{y} dx
}
for $y^2 = (1-x^2)(1-k^2 x^2)$. 
\item Use the identities 
\eq{
\frac{x^2-a}{x^2-b} &= 1 + \frac{b-a}{x^2-b} \\
\frac{1}{(x^2-a)(x^2-b)} &= (a-b)^{-1}\pround{\frac{1}{x^2-a} - \frac{1}{x^2-b}}
}
to reduce to the classes of integrals
\eq{
I_n &= \int \frac{x^{2n}}{y} \, dx  \quad (n \geq 0) \\
I_n^\prime &= \int \frac{(x^2-c^2)^n}{y} \, dx \quad (n < 0)
}
for $y^2 = (1-x^2)(1-k^2 x^2)$.
\item Use relation 
\eq{
n I_{n-1} -n(1+k^2)I_n + (n+1)k^2 I_{n+1} -\frac{1}{2}(1+k^2)I_n = x^{2n}y + \text{cst}
}
to reduce $I_n$ to $I_0$ and $I_1$. A similar technique can be applied to reduce $I_n^\prime$ to $I_{-1}^\prime$ and $I_0^\prime=I_0$. 
\end{enumerate}

\begin{idea}
	The irreducible incomplete integrals are those of the first, second, and third kind:
\eq{
I_0 &= \int \frac{1}{\sqrt{(1-x^2)(1-k^2x^2)}}	dx \\
I_0 - k^2 I_1 &= \int \sqrt{\frac{1-k^2 x^2}{1-x^2}} dx \\
I_{-1}^\prime &= \int \frac{1}{(x^2-c^2)\sqrt{(1-x^2)(1-k^2x^2)}}	dx
}
\end{idea}

A lemma useful in the reduction is the following:
\begin{prop}
	Suppose the map sending $e_0, \dots, e_3 \mapsto \pm 1, \pm \frac{1}{k}$ is 
	\eq{
f(z) = \frac{az+b}{cz+d}	
}
Then if we make the substitution $t = \frac{ax+b}{cx+d}$ we have 
\eq{
Q(x) = \prod(x-e_i) = \frac{(1-t^2)(1-k^2t^2)}{(a-ct)^4 \prod (ce_i+d)^{-1}}
}
and 
\eq{
dx = \frac{ad-bc}{(a-ct)^2} dt 
}
\end{prop}
\begin{proof}
The inverse transform is 
	\eq{
x = \frac{dt-b}{a-ct}	
}
so 
\eq{
x-e_i &= \frac{(dt-b) - e_i(a-ct)}{a-ct} \\
&= \frac{(ce_i+d)t-(ae_i+b)}{a-ct} \\
&= \frac{t - f(e_i)}{(a-ct)(ce_i+d)^{-1}}
}
The first part then follows by taking the product and knowing that the $f(e_i)$ are the roots of $(1-x^2)(1-k^2x^2)$. For the second part we directly calculate. 
\eq{
dx &= \frac{d }{a-ct}(dt) +  \frac{dt-b}{(a-ct)^2}c(dt) \\
&= \frac{ad-bc}{(a-ct)^2} \, (dt)
}
\end{proof}

\begin{corollary}
	We have
	\eq{
\int \frac{dx}{\sqrt{(x-e_0)(x-e_1)(x-e_2)(x-e_3)}}= \frac{ad-bc}{\prod \sqrt{ce_i + d}} \int \frac{dt}{\sqrt{(1-t^2)(1-k^2t^2)}}	
}
\end{corollary}

\begin{lemma}
	The map sending $-1,\frac{1}{k},-\frac{1}{k} \mapsto 0,1,\infty$ is 
	\eq{
z \mapsto \frac{2k}{1+k} \frac{1+z}{1+kz}	
} 
and the inverse is 
\eq{
z \mapsto \frac{1}{k}\frac{(1+k)z-2k}{-(1+k)z+2}
}
\end{lemma}
\begin{remark}
	\hl{The above map isn't normalised yet, so fix it}
\end{remark}

\begin{example}
	Consider the integral 
	\eq{
I = \int_0^2 \frac{1}{\sqrt{(2x-x^2)(4x^2+9)}} dx	
}
We start by making $Q$ monic by pulling out the factor of $2$. This gives 
	\eq{
	I = \frac{1}{2}\int_0^2 \frac{1}{\sqrt{(2x-x^2)(x^2+\sfrac{9}{4})}} dx	
}
As such we have $Q(x) = -x(x-2)(x-\sfrac{3i}{2})(x+\sfrac{3i}{2})$. We can  calculate the cross ratio for sending $0 \mapsto C, 2 \mapsto 0, \frac{3i}{2} \mapsto 1, \frac{-3i}{2}\mapsto \infty$:
\eq{
C = \frac{0-2}{0+\sfrac{3i}{2}}\frac{\sfrac{3i}{2}+\sfrac{3i}{2}}{\sfrac{3i}{2}-2} = \frac{-4}{\sfrac{3i}{2}-2} = \frac{2i}{\sfrac{3}{4}+i}
}
This corresponds to a value of $k=\frac{i}{2}$. We want to construct a map sending $0,2,\frac{3i}{2},-\frac{3i}{2} \mapsto 1,-1,\frac{1}{k}, -\frac{1}{k}$ so we consider 
\eq{
z \mapsto \frac{z+b}{cz+d}
}
Imposing the conditions finds $b=d=-(1+c) = -\frac{3}{4}$. We can, without changing our answer, rescale all of these to integers to make out answer easier. For this transform we find $ad-bc=-15$. Further
\eq{
- 0 -3&= -3 \\
- 2 -3&= - 5 \\
-\frac{3i}{2} -3&= -\pround{3 + \frac{3i}{2}}\\
- \frac{-3i}{2} -3&= -\pround{3 - \frac{3i}{2}}
} 
giving 
\eq{
\prod (ce_i + d)^{-\frac{1}{2}} = \frac{2}{15\sqrt{3}}
}
so after the transform 
\eq{
I = \frac{-15}{2}\times \frac{2}{15\sqrt{3}} \int_1^{-1} \frac{dt}{\sqrt{-(1-t^2)(1-k^2t^2)}} = \frac{2}{\sqrt{3}}K\pround{\frac{i}{2}}
}
for $k=\frac{i}{2}$. \hl{plus a factor of i I have missed.} Using 
\eq{
K(ik) &= \frac{1}{\sqrt{1+k^2}} K\pround{\frac{k}{\sqrt{1+k^2}}} \\
\Rightarrow K\pround{\frac{i}{2}} &= \frac{2}{\sqrt{5}} K \pround{\frac{1}{\sqrt{5}}}
}
\hl{answer off by a factor of 4i}
\end{example}
	
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bibliographystyle{../bib/custom-bib-style}
\bibliography{../bib/library,../bib/manual}

\end{document}